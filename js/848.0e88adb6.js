"use strict";(self["webpackChunkproject_vue"]=self["webpackChunkproject_vue"]||[]).push([[848],{7223:function(t,e,i){i.r(e),i.d(e,{default:function(){return N}});var s=i(3694),n=i(6190),a=i(9582),l=i(4886),o=i(266),c=i(9256),r=i(5125),u=i(4324),d=i(1713),_=i(9730),m=i(9449),h=i(2540),v=i(7808),p=function(){var t=this,e=t._self._c;return e("div",[e(h.Z,{staticClass:"d-flex justify-space-between align-center"},[e("h3",[t._v("Facture et ventes")])]),e(s.Z,{attrs:{dense:"",type:"info",color:"indigo"}},[t._v(" Cette partie du HumanApp porte sur les fonctionnalités liées à la gestion des factures et vente ")]),e(a.Z,[e(l.EB,{staticClass:"d-flex-inline"},[e(d.Z,[e("h5",[t._v("Société, Human Atm, Facturation")])])],1)],1),e(c.Z,[e(d.Z,[e(o.Z,{attrs:{cols:"5",sm:"3"}},[e(_.Z,{attrs:{items:t.stock_merchandises,"item-text":"title","item-value":"id_stock",label:"Item"},on:{change:function(e){t.verifyAmount(),t.seek_amount_and_price_stock()}},model:{value:t.id_stock,callback:function(e){t.id_stock=e},expression:"id_stock"}})],1),e(o.Z,[e(v.Z,{attrs:{type:"number",step:"any",label:"Pu",required:""},model:{value:t.pu_sale,callback:function(e){t.pu_sale=e},expression:"pu_sale"}})],1),e(o.Z,[e(v.Z,{attrs:{type:"number",step:"any",label:"Qté",required:""},model:{value:t.amount_sale,callback:function(e){t.amount_sale=e},expression:"amount_sale"}})],1),e(o.Z,{attrs:{cols:"2",sm:"4"}},[e(s.Z,{attrs:{color:"blue-grey",dark:""}},[t._v(" Prix total: "+t._s(Number(t.amount_sale*t.pu_sale).toFixed(4))+" ")])],1),t.pu_by?e(o.Z,{staticClass:"d-flex",attrs:{cols:"12",sm:"6"}},[e(s.Z,{attrs:{color:"dense",type:"info"}},[t._v("Le pua de ce bien était de "+t._s(t.pu_by)+" $ et il restait "+t._s(t.amount_by)+" unités ")])],1):t._e(),e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(n.Z,{staticClass:"mb-1",on:{click:function(e){t.verifyAmount(),t.submitNewItemInvoice()}}},["add"!=t.indexEdit?e("span",[t._v("Editer")]):e("span",[t._v("Ajouter")])])],1)],1),e(r.Z,{staticClass:"mb-10",attrs:{method:"post"}},[e("div",[e(m.Z,[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v(" IdStock ")]),e("th",{staticClass:"text-left"},[t._v(" Marchandise ")]),e("th",{staticClass:"text-left"},[t._v(" Pu ")]),e("th",{staticClass:"text-left"},[t._v(" Qté ")]),e("th",{staticClass:"text-left"},[t._v(" Prix Total ")]),e("th",{staticClass:"text-left"},[t._v(" Actions ")])])]),e("tbody",t._l(t.listOfitemInvoices,(function(i,s){return e("tr",{key:i.id_stock},[e("td",[t._v(t._s(i.id_stock))]),e("td",[t._v(t._s(i.title))]),e("td",[t._v(t._s(i.pu_sale))]),e("td",[t._v(t._s(i.amount_sale))]),e("td",[t._v(t._s(Number(i.pu_sale*i.amount_sale).toFixed(3)))]),e("td",[e(u.Z,{attrs:{small:"",color:"purple"},on:{click:function(e){return t.editItemInvoice(s)}}},[t._v("mdi-pencil ")]),e(u.Z,{attrs:{small:"",color:"red"},on:{click:function(e){return t.deleteItemInvoice(s)}}},[t._v(" mdi-delete ")])],1)])})),0)])],1),e(d.Z,{staticClass:"mt-4"},[e(o.Z,{attrs:{cols:"12",sm:"6"}},[e(v.Z,{attrs:{type:"text",label:"Client",required:""},model:{value:t.client,callback:function(e){t.client=e},expression:"client"}}),t.getNumberInvoices()>0?e("div",[e(v.Z,{attrs:{type:"date",label:"Date de Vente",value:"created_at",required:""},model:{value:t.created_at,callback:function(e){t.created_at=e},expression:"created_at"}},[t._v(" "+t._s(t.created_at)+" ")]),e(v.Z,{attrs:{type:"number",step:"any",label:"Reduction sur facture"},model:{value:t.decrease,callback:function(e){t.decrease=e},expression:"decrease"}}),t.listOfitemInvoices?e(s.Z,{attrs:{color:"indigo",dark:""}},[t._v(" Prix total net à payer : "+t._s(t.getTotalPriceAmount())+" ")]):t._e()],1):t._e()],1)],1),t.printInvoice?e(n.Z,{staticClass:"d-flex mt-10",on:{click:function(e){return e.stopPropagation(),t.exportToPDF()}}},[t._v(" Print ")]):t._e(),e(n.Z,{staticClass:"d-flex mt-10",on:{click:function(e){return e.stopPropagation(),t.create_new_line_invoice()}}},[t._v(" Enregistrer ")])],1),e("resultInvoice",{key:t.resultInvoiceKey})],1)],1)},f=[],I=i(9669),y=i.n(I),k=i(599),b=i.n(k),x=i(5151),g=function(){var t=this,e=t._self._c;return e("div",[e(h.Z,{staticClass:"d-flex justify-space-between align-center"},[e("h3",[t._v("Résultats")])]),e(a.Z,[e(l.EB,{staticClass:"d-flex-inline"},[e(d.Z,[e("h6",[t._v("All")])])],1),e(l.ZB,[e(x.Z,{staticClass:"elevation-1",attrs:{headers:t.header_lineinvoices,items:t.listInlines,"items-per-page":5},scopedSlots:t._u([{key:"item.actions",fn:function({item:i}){return[e(u.Z,{attrs:{small:"",color:"purple"},on:{click:function(e){return t.printInvoiceInline(i)}}},[t._v(" mdi-printer ")]),e(u.Z,{staticClass:"mr-2",attrs:{small:"",color:"red"},on:{click:function(e){return e.stopPropagation(),t.deleteInvoiceInline(i)}}},[t._v(" mdi-delete ")])]}}])})],1)],1),t.printLinePermit?e(a.Z,{staticClass:"mt-10"},[e("div",{attrs:{id:"element-to-convert"}},[e(l.EB,[e(d.Z,[e(o.Z,[e("div",{staticStyle:{display:"inline"}},[e("h4",[t._v("Sté HumanATM")]),e("h4",[t._v("Client : "+t._s(t.inlineInfo.client))]),e("h6",[t._v("Date : "+t._s(t.inlineInfo.created_at))])])])],1)],1),e(l.ZB,[e(m.Z,[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[t._v(" Title ")]),e("th",{staticClass:"text-left"},[t._v(" P.U ")]),e("th",{staticClass:"text-left"},[t._v(" Qté ")]),e("th",{staticClass:"text-left"},[t._v(" Pt ")])])]),e("tbody",t._l(t.listInvoicesPrint,(function(i,s){return e("tr",[e("td",[t._v(t._s(i.title))]),e("td",[t._v(t._s(i.pu_sale))]),e("td",[t._v(t._s(i.amount_sale))]),e("td",[t._v(t._s(Number(i.pt).toFixed(3)))])])})),0)]),e("div",{staticStyle:{display:"inline","text-align":"right","margin-right":"10px"}},[e("h6",{staticClass:"mt-10 font-weight-black"},[t._v("Total Brut: "+t._s(Number(t.computeTotalPriceTopay()).toFixed(3))+"$ ")]),e("h6",{staticClass:"font-weight-black"},[t._v("Réduction : "+t._s(t.inlineInfo.decrease)+"$")]),e("h6",{staticClass:"font-weight-black"},[t._v("Prix total à payer : "+t._s(Number(t.computeTotalPriceTopay()-t.inlineInfo.decrease).toFixed(3))+"$ ")])])],1)],1),e(n.Z,{staticClass:"mt-10",attrs:{color:"error"},on:{click:function(e){return t.printMethode()}}},[t._v("imprimer")]),e(n.Z,{staticClass:"ml-10 mt-10",attrs:{color:"info"},on:{click:function(e){t.printLinePermit=!t.printLinePermit}}},[t._v("Annuler")])],1):t._e()],1)},Z=[],C={name:"resultInvoice",components:{},data:()=>({listInvoices:[],urlImage:"../assets/atmlogo.jpg",listInlines:[],printLinePermit:!1,printinline:[],listInvoicesPrint:[],inlineInfo:[],header_lineinvoices:[{text:"idOp",align:"start",sortable:!0,value:"id_line"},{text:"Client",value:"client"},{text:"Date",value:"created_at"},{text:"Prix Total ",value:"totalprice"},{text:"Reduction Accordée",value:"decrease"},{text:"Net à payer",value:"net_total_price"},{text:"actions",value:"actions"}]}),methods:{computeTotalPriceTopay(){var t=0;return this.listInvoicesPrint.forEach((e=>{t+=e.pt})),t},async printInvoiceInline(t){try{const e=await y().post("lineInvoice/getInvoiceInfo/"+t.id_line);this.listInvoicesPrint=e.data,this.printinlineinfo(t.id_line),this.printLinePermit=!this.printLinePermit}catch(e){console.log(e)}},async printinlineinfo(t){try{const e=await y().post("lineInvoice/getInlineInfo/"+t);this.inlineInfo=e.data,console.log(this.inlineInfo)}catch(e){console.log(e)}},async printMethode(){b()(document.getElementById("element-to-convert"),{margin:5,filename:"facture -"+this.inlineInfo.client+"-"+this.inlineInfo.created_at,jsPDF:{format:"a6",orientation:"portrait"}})},async deleteInvoiceInline(t){if(confirm("Voulez-vous supprimer cette facture de l'operation "+t.id_line+" ?"))try{const e=await y().post("lineInvoice/deleteInvoice/"+t.id_line);this.listInvoices=e.data,this.get_listInlines()}catch(e){console.log(e)}},async get_listInvoices(){try{const t=await y().post("invoice/");this.listInvoices=t.data}catch(t){console.log(t)}},async get_listInlines(){try{const t=await y().post("lineInvoice/");this.listInlines=t.data}catch(t){console.log(t)}}},created(){this.get_listInvoices(),this.get_listInlines()}},P=C,O=i(1001),w=(0,O.Z)(P,g,Z,!1,null,null,null),E=w.exports,T={name:"Invoice",components:{resultInvoice:E},data:()=>({indexEdit:"add",resultInvoiceKey:!1,printInvoice:null,editOradd:null,created_at:(new Date).toJSON().slice(0,10).replace(/-/g,"/"),client:"",title:"",decrease:"",pu_sale:"",amount_sale:"",id_stock:"",stock_merchandises:[],pu_by:"",amount_by:"",listOfitemInvoices:[],lastIdLine:"",invoicesRequests:[],desserts:[{name:"Frozen Yogurt",calories:159}]}),methods:{getNumberInvoices(){return this.listOfitemInvoices.length},getTotalPriceAmount(){let t=0;return this.listOfitemInvoices.forEach((e=>{t+=e.amount_sale*e.pu_sale})),t=Number(t-this.decrease).toFixed(3),t},submitNewItemInvoice(){if(""!=this.id_stock&&""!=this.pu_sale&&""!=this.amount_sale)if(Math.abs(this.amount_by)<Math.abs(this.amount_sale))alert("Quantité en stock non suffisante pour effectuer cette opération !");else{if("add"!=this.indexEdit)this.listOfitemInvoices[this.indexEdit].pu_sale=Math.abs(this.pu_sale),this.listOfitemInvoices[this.indexEdit].amount_sale=Math.abs(this.amount_sale),this.listOfitemInvoices[this.indexEdit].id_stock=Math.abs(this.id_stock);else{var t=!1;if(this.listOfitemInvoices.forEach((e=>{e.id_stock==this.id_stock&&(t=!0,alert("Au lieu d'insérer le meme item veuillez éditer celui qui est déjà présent sur la facture"))})),1==t)return;this.listOfitemInvoices.push({id_stock:this.id_stock,title:this.title,pu_sale:Math.abs(this.pu_sale),amount_sale:Math.abs(this.amount_sale)})}this.title="",this.pu_sale="",this.amount_sale="",this.id_stock="",this.pu_by="",this.indexEdit="add"}else alert("Veuillez completer tous les éléments du formulaire")},editItemInvoice(t){this.title=this.listOfitemInvoices[t].title,this.pu_sale=this.listOfitemInvoices[t].pu_sale,this.amount_sale=this.listOfitemInvoices[t].amount_sale,this.id_stock=this.listOfitemInvoices[t].id_stock,this.indexEdit=t},deleteItemInvoice(t){this.listOfitemInvoices.splice(t,1),this.indexEdit==t&&(this.title="",this.pu_sale="",this.amount_sale="",this.id_stock="",this.indexEdit="add",this.pu_by="")},seek_amount_and_price_stock(){this.stock_merchandises.forEach((t=>{t.id_stock==this.id_stock&&(this.pu_by=t.pu_by,this.title=t.title)}))},async get_stock_merchandise(){try{const t=await y().post("stock_merchandise/");this.stock_merchandises=t.data}catch(t){alert(t)}},async verifyAmount(){if(""!=this.id_stock){const t=await y().post("invoice/verifyAmount/"+this.id_stock);this.amount_by=t.data}},async create_new_line_invoice(){if(""!=this.client&&this.getNumberInvoices()>0)try{const t=new FormData;t.append("client",this.client),t.append("decrease",this.decrease),t.append("created_at",this.created_at+this.getCurrentTime()),t.append("listOfitemInvoices",this.created_at+this.listOfitemInvoices);const e=await y().post("lineInvoice/create",t);this.lastIdLine=e.data,this.async_create_each_invoice(),alert("Facture enregistrée avec succès")}catch(t){alert(t)}else alert("Veuiller d'abord compléter tous les champs requis pour une facture")},async async_create_each_invoice(){const t=new FormData;t.append("listOfitemInvoices",JSON.stringify(this.listOfitemInvoices));try{await y().post("invoice/create",t);this.listOfitemInvoices=[],this.decrease="",this.client="",this.resultInvoiceKey=!this.resultInvoiceKey,console.log("Opération éffectuée avec succès ! ")}catch(e){console.log(e)}},getCurrentTime(){const t=new Date,e=":"+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return e}},created(){this.get_stock_merchandise()}},A=T,F=(0,O.Z)(A,p,f,!1,null,"72be6e34",null),N=F.exports}}]);
//# sourceMappingURL=848.0e88adb6.js.map